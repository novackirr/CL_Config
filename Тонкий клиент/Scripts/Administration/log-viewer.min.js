(function(){})(window.ct=window.ct||{}),function(n){function t(n){this._baseUrl=n[n.length-1]==="/"?n:n+"/"}n.LogViewerApiService=t;t.prototype=Object.create(ct.api.ApiService.prototype);t.prototype.constructor=t;t.prototype.getItems=function(n,t,i){var r=this._baseUrl+"GetLogs?path="+n.replace(/_/g,"%")+"&start="+t+"&end="+i;return this.get(r).then(function(n){return n.response})};t.prototype.getFile=function(n){return this._baseUrl+"GetFile?file"+n};t.create=function(n){return new t(n)}}((window.ct=window.ct||{},window.ct.api=window.ct.api||{}));LogViewer=function(n){function h(){var n=$(t.containerSelector).attr("data-base-url");i=ct.api.LogViewerApiService.create(n);f=$(t.containerSelector).dxResponsiveBox({rows:[{ratio:1}],cols:[{ratio:1}]});$(t.refreshSelector).click(function(){$(t.dataGridSelector).dxDataGrid("getDataSource").reload()});r=new DevExpress.data.CustomStore({key:"id",load:function(){var n=$(t.startSelector).val(),r=$(t.endSelector).val();return i.getItems(o,n,r).then(function(n){return s=n,n})},insert:function(){console.log("-- INSERT")},update:function(){console.log("-- UPDATE")},remove:function(){console.log("-- REMOVE")}});u=new DevExpress.data.DataSource({store:r,pageSize:3});DevExpress.localization.locale("ru");e=$(t.dataGridSelector).dxDataGrid({grouping:{contextMenuEnabled:!0,expandMode:"buttonClick",allowCollapsing:!0},groupPanel:{visible:!1},columns:[{caption:"Имя файла",dataField:"Name",allowEditing:!1,allowGrouping:!1},{caption:"Папка",dataField:"Folder",allowEditing:!1,allowGrouping:!0,groupIndex:0},{caption:"Дата создания",dataField:"Date",allowEditing:!1,allowGrouping:!1},{caption:"Дата изменения",dataField:"LastDate",allowEditing:!1,allowGrouping:!1},{caption:"Размер",dataField:"Size",allowEditing:!1,allowGrouping:!1},{caption:"Действие",dataField:"id",cellTemplate:function(n,t){$("<div>").append($("<a>",{href:window.location.href.replace("LogViewer","GetFile?file=")+t.value,title:"Скачать файл"}).html("Скачать файл")).appendTo(n)},allowEditing:!1}],dataSource:u,scrolling:{mode:"infinite",rowRenderingMode:"virtual"},paging:{pageSize:200},selection:{mode:"single"},repaintChangesOnly:!0,width:"1024px"})}var t={containerId:"log-viewer-"+n+"-container",dataGridId:"log-viewer-"+n+"-datagrid",startSelector:"#log-viewer-"+n+"-start",endSelector:"#log-viewer-"+n+"-end",refreshSelector:"#log-viewer-"+n+"-refresh",containerSelector:"#log-viewer-"+n+"-container",dataGridSelector:"#log-viewer-"+n+"-datagrid"},f,e,i,o=n,r,u,s=[];return{init:h}};