function onSelectFlow(n){showLoadingIndicator(".register-flow-selectors .loading-image");onSelectNavigate(n)}function onSelectFlowUrl(n){showLoadingIndicator(".register-flow-selectors .loading-image");document.location=n}function expandBlocksWithRequiredEmptyFields(){$(".register-form [required]").each(function(){if(!$(this).val()){var n=$(this).closest(".panel-collapse");n.hasClass("collapse")&&!n.hasClass("in")&&n.collapse("show");$($(this).closest(".table-row-row-view")).css("display")=="none"&&$(this).closest(".table-row-row-view").parent().find(".table-row-selector-radio").click()}})}function fillFromTemplateSubmitProcessor(n,t,i){var u=$("input[name=template]:checked").val(),r;u&&($("#TemplateIDToFillFrom").val(u),r=$("#register-form"),r.attr("action",i),toggleRegisterFormRequired(r,!1),r.unbind("submit"),r.find("[type='submit']").click())}function submitRegisterForm(n,t,i,r){var u,f,e;if(setPreventDefault(r),!$(i).prop("disabled")){if(u=$(i).closest("form"),f=u.find("input[name='"+t+"']"),f.val(n),(n=="project"||n=="template")&&toggleRegisterFormRequired(u,!1),n=="document"){e=$(".register-form").first().parsley();expandBlocksWithRequiredEmptyFields();e.whenValidate().done(function(){if(document.referrer.indexOf(getBaseURI())>-1){var n=new URL(document.referrer);n.pathname.indexOf("DocumentView")>-1&&history.replaceState({page:1},"",getBaseURI())}u.find("[type='submit']").click()});return}u.find("[type='submit']").click()}}function getBaseURI(){if(document.baseURI)return document.baseURI;var n=document.getElementsByTagName("base");return n.length>0?n[0].href:document.URL}function toggleRegisterFormRequired(n,t){t?n.find("[data-register-required]").each(function(){var n=$(this).attr("data-register-required").toLowerCase()=="true";$(this).prop("required",n);$(this).removeAttr("data-register-required")}):n.find("[required]").each(function(){$(this).prop("required",!1);$(this).attr("data-register-required",!0)})}function subscripeRegisterFormSubmit(n){var t=function(){return document.getElementById("register-form")},h=function(){return document.getElementById("error-message")},f=function(){return"#register-form .loading-image"},o=function(){showLoadingIndicator(f());$(t()).find("[type='submit'], .register-form-buttons a").prop("disabled",!0);$("form").find(".checkbox-wrapper input[type=checkbox]").each(function(n,t){var i=$(t);i.is(":checked")&&i.siblings().removeAttr("name")})},r=function(){hideLoadingIndicator(f());$(t()).find("[type='submit'], .register-form-buttons a").prop("disabled",!1);$(t()).find("input[name='registerMode']").val("")},u,i=t(),s=function(){$(i).bind("submit",u)},e=function(){$(i).unbind("submit",u)};u=function(u){(setPreventDefault(u),$(t()).find("input[name='registerMode']").val()&&$("form").first().parsley().isValid())&&(o(),ajaxFormSubmit(i,function(u,f,o){console.log(u);o?showCommonErrors(o,function(){afterFormSubmitHandler($(i),u).then(function(){if(e(),n.indexOf("?")!==-1){var t=n.split("?");document.location=t[0]+"/"+u+"?"+t[1]}else document.location=n+"/"+u},function(n){showCommonErrors(n);toggleRegisterFormRequired($(t()),!0);r()})},!0):afterFormSubmitHandler($(i),u).then(function(){if(e(),n.indexOf("?")!==-1){var t=n.split("?");document.location=t[0]+"/"+u+"?"+t[1]}else document.location=n+"/"+u},function(n){showCommonErrors(n);toggleRegisterFormRequired($(t()),!0);r()})},function(n){n.allMessages?showCommonErrors(n.allMessages):showCommonErrors(n.responseText);toggleRegisterFormRequired($(t()),!0);r()},beforeAjaxSendRegisterForm))};s()}function afterFormSubmitHandler(n,t){var i=jQuery.Deferred(),u={docKey:t},r=n.triggerHandler("afterFormSubmit",u);return r&&r.always?r.then(function(){i.resolve()},function(n){i.reject(n)}):i.resolve(),i.promise()}function beforeAjaxSendRegisterForm(n){$("form").find("input[name='DisableLinkDocsLockAndRefresh']").length>0&&n.setRequestHeader("DisableLinkDocsLockAndRefresh","1");$("form").find("input[name='DisableRightsRecalcForLinks']").length>0&&n.setRequestHeader("DisableRightsRecalcForLinks","1")}