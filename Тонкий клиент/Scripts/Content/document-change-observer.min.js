var DocumentChangeObserver=function(n,t,i,r,u,f){function g(n,t){h=t;p=n;setTimeout(o,d);window.onfocus=function(){l=!0};window.onblur=function(){l=!1}}function nt(){s=v;console.log("disable observer")}function a(){s=0;o();console.log("restart observer")}function tt(){e||(e=!0)}function o(){e||(s++,s>v)||(l?$.ajax({url:w,dataType:"json",timeout:y,cache:!1,data:{docKey:p,currentDocHash:h},beforeSend:function(n){n.setRequestHeader("RemoveAuthDialog","true")}}).done(function(n){n?k():setTimeout(o,c)}).fail(function(){console.log("Произошла ошибка при запросе смены хэша документа");setTimeout(o,c)}):setTimeout(o,c))}function it(n){$.ajax({url:b,dataType:"json",timeout:y,cache:!1,data:{docKey:n}}).done(function(n){h=n;e=!1;a()}).fail(function(){h="";e=!1;a()})}var w=n,b=t,k=i,c=u,v=f,s=0,y=18e4,d=r,p,h,l=!0,e=!1;return{startObserveDocumentChanged:g,disable:nt,restart:a,pause:tt,doHashRefresh:it}};